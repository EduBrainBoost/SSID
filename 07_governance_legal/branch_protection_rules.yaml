# Branch Protection Rules for SSID Repository
# Blueprint v4.2 - Governance Enforcement
# Repository: https://github.com/EduBrainBoost/SSID
# Branch: main

branch_protection:
  branch_name_pattern: main
  
  # Require pull request reviews before merging
  required_pull_request_reviews:
    required_approving_review_count: 1
    dismiss_stale_reviews: true
    require_code_owner_reviews: false
    require_last_push_approval: false
  
  # Require status checks to pass before merging
  required_status_checks:
    strict: true  # Require branches to be up to date before merging
    contexts:
      - "Structure Guard / guard"
      - "Root-24-LOCK Validation"
  
  # Enforce restrictions
  enforce_admins: true  # Include administrators in restrictions
  
  # Required linear history
  required_linear_history: false  # Allow merge commits
  
  # Allow force pushes
  allow_force_pushes: false  # Block force pushes
  
  # Allow deletions
  allow_deletions: false  # Block branch deletion
  
  # Require signed commits
  require_signed_commits: true  # Enforce commit signing
  
  # Required conversation resolution before merging
  required_conversation_resolution: true

# Additional recommendations
recommendations:
  - Enable "Require deployments to succeed before merging" if deployment checks are configured
  - Consider enabling "Require review from Code Owners" when CODEOWNERS file is added
  - Set up GitHub Advanced Security for additional code scanning
  - Enable Dependabot for automated dependency updates
  - Configure branch protection for release branches (e.g., release/*)

# GitHub CLI command to apply these rules:
# gh api repos/EduBrainBoost/SSID/branches/main/protection \
#   --method PUT \
#   --field required_status_checks='{"strict":true,"contexts":["Structure Guard / guard","Root-24-LOCK Validation"]}' \
#   --field enforce_admins=true \
#   --field required_pull_request_reviews='{"required_approving_review_count":1,"dismiss_stale_reviews":true}' \
#   --field restrictions=null \
#   --field required_signatures=true \
#   --field allow_force_pushes=false \
#   --field allow_deletions=false \
#   --field required_conversation_resolution=true

# Alternative: Apply via GitHub Web UI
# 1. Go to Settings > Branches
# 2. Add rule for branch name pattern: main
# 3. Configure options as specified above
# 4. Save changes

{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://ssid.global/schemas/rat_zone_v5_2.json",
  "title": "RAT Zone Resolution Model v5.2",
  "description": "JSON Schema for Region Activation Token (RAT) zone-based rate limiting with tier-specific enforcement",
  "type": "object",
  "required": [
    "version",
    "model_name",
    "zones",
    "enforcement_policy",
    "epistemic_certainty"
  ],
  "properties": {
    "version": {
      "type": "string",
      "enum": ["5.2"],
      "description": "Schema version"
    },
    "model_name": {
      "type": "string",
      "const": "rat_zone_resolution_v5_2",
      "description": "Canonical model name"
    },
    "zones": {
      "type": "object",
      "required": ["Z1", "Z2", "Z3"],
      "properties": {
        "Z1": {
          "$ref": "#/definitions/zone"
        },
        "Z2": {
          "$ref": "#/definitions/zone"
        },
        "Z3": {
          "$ref": "#/definitions/zone"
        }
      },
      "additionalProperties": false
    },
    "enforcement_policy": {
      "type": "object",
      "required": ["mode", "tier_mapping"],
      "properties": {
        "mode": {
          "type": "string",
          "enum": ["strict", "permissive"],
          "description": "Enforcement mode for rate limiting"
        },
        "tier_mapping": {
          "type": "object",
          "required": ["S1", "S2", "S3", "S3_prime"],
          "properties": {
            "S1": {
              "type": "string",
              "enum": ["Z1", "Z2", "Z3"]
            },
            "S2": {
              "type": "string",
              "enum": ["Z1", "Z2", "Z3"]
            },
            "S3": {
              "type": "string",
              "enum": ["Z1", "Z2", "Z3"]
            },
            "S3_prime": {
              "type": "string",
              "enum": ["Z1", "Z2", "Z3"]
            }
          }
        }
      }
    },
    "epistemic_certainty": {
      "type": "number",
      "minimum": 1.0,
      "maximum": 1.0,
      "description": "Deterministic certainty required for v5.2"
    }
  },
  "definitions": {
    "zone": {
      "type": "object",
      "required": ["name", "rate_limit", "burst_limit", "window_seconds"],
      "properties": {
        "name": {
          "type": "string",
          "enum": ["Z1", "Z2", "Z3"]
        },
        "rate_limit": {
          "type": "integer",
          "minimum": 1,
          "description": "Requests per window"
        },
        "burst_limit": {
          "type": "integer",
          "minimum": 1,
          "description": "Maximum burst requests"
        },
        "window_seconds": {
          "type": "integer",
          "minimum": 1,
          "maximum": 3600,
          "description": "Time window in seconds"
        },
        "regions": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Geographic regions in this zone"
        },
        "priority": {
          "type": "integer",
          "minimum": 1,
          "maximum": 10,
          "description": "Zone priority (1=highest)"
        }
      }
    }
  }
}

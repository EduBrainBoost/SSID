version: 1.0.0
title: Placeholder Code Management Policy
description: |
  Defines acceptable placeholder patterns and deferral strategy for phased implementation.
  Ensures audit-compliant placeholder management with clear roadmap justification.

compliance_requirement:
  id: PLACEHOLDER-MANAGEMENT
  tier: MUST
  category: code_quality
  regulation_references:
    - "ISO 27001:2022 (Software Development Lifecycle)"
    - "DORA Art. 6 (ICT Risk Management)"
    - "GDPR Art. 25 (Privacy by Design - no incomplete security features)"

placeholder_philosophy:
  acceptable_use: |
    Placeholders are acceptable when:
    1. Clearly documented as deferred to future sprint
    2. Part of documented phased rollout plan
    3. Do not compromise security or compliance
    4. Have explicit roadmap item with timeline

  unacceptable_use: |
    Placeholders are NOT acceptable when:
    1. In security-critical paths (auth, crypto, audit)
    2. In production-ready modules without deferral justification
    3. Undocumented or lacking roadmap reference
    4. Blocking current sprint compliance requirements

allowed_placeholders:
  # Pattern 1: Shard Middleware Stubs (Sprint 3+ Deferral)
  - pattern: 'NotImplementedError.*Placeholder - requires implementation in Sprint 3'
    reason: "Shard middleware implementations deferred to Sprint 3+ per phased rollout"
    exempt_paths:
      - "*/shards/*/implementations/*/src/api/middleware.py"
    documented_in: "roadmap/sprint3_shards.md"
    audit_status: "ACCEPTABLE (documented deferral)"
    max_occurrences: 500  # 16 shards Ã— ~30 modules
    expires: "2025-12-31"  # Sprint 3 target date

  # Pattern 2: Future Integration Hooks (TODO with Issue Link)
  - pattern: '# TODO: Integration with .* \(Issue #\d+\)'
    reason: "Future integration points with tracked GitHub issues"
    exempt_paths:
      - "*/utils/*.py"
      - "*/tools/*.py"
    documented_in: "GitHub Issues"
    audit_status: "ACCEPTABLE (issue-tracked)"
    max_occurrences: 50
    expires: null  # No expiry (ongoing backlog)

  # Pattern 3: Legacy Code Preservation (Archive Only)
  - pattern: '# TODO: .*'
    reason: "Legacy code preserved for reference (not production)"
    exempt_paths:
      - "*/evidence/legacy/**"
      - "*/legacy/**"
    documented_in: "Legacy archive policy"
    audit_status: "ACCEPTABLE (archived, non-production)"
    max_occurrences: 100
    expires: null  # Archive is permanent

forbidden_placeholders:
  # Critical paths must NEVER have placeholders
  - pattern: 'pass  # placeholder'
    forbidden_paths:
      - "*/security/**"
      - "*/crypto/**"
      - "*/audit_logging/**"
      - "*/anti_gaming/**"
    severity: "CRITICAL"
    action: "BLOCK_COMMIT"

  - pattern: 'raise NotImplementedError'
    forbidden_paths:
      - "*/worm_storage/**"
      - "*/blockchain_anchor/**"
      - "*/non_custodial/**"
    severity: "CRITICAL"
    action: "BLOCK_COMMIT"

  - pattern: 'pytest.skip\("Placeholder'
    forbidden_paths:
      - "*/tests/test_*_security.py"
      - "*/tests/test_*_compliance.py"
    severity: "HIGH"
    action: "REQUIRE_JUSTIFICATION"

enforcement:
  mode: "STRICT"  # STRICT | WARN | AUDIT_ONLY

  scanner_integration:
    tool: "12_tooling/placeholder_guard/placeholder_scan_v2.py"
    scan_frequency: "pre-commit + CI/CD"
    whitelist_source: "this file (placeholder_policy.yaml)"

  violation_handling:
    - severity: "CRITICAL"
      condition: "Forbidden placeholder in critical path"
      action: "BLOCK_COMMIT"
      notification: "Security Team + Compliance Lead"

    - severity: "HIGH"
      condition: "Allowed placeholder exceeds max_occurrences"
      action: "WARN + REQUIRE_EXCEPTION"
      notification: "Engineering Lead"

    - severity: "MEDIUM"
      condition: "Allowed placeholder approaching expiry (30 days)"
      action: "WARN"
      notification: "Module Maintainer"

    - severity: "LOW"
      condition: "Undocumented placeholder (not in policy)"
      action: "WARN + CREATE_ISSUE"
      notification: "Developer"

  ci_cd_gate:
    enabled: true
    gate_name: "placeholder-policy-validator"
    script: "12_tooling/placeholder_guard/placeholder_scan_v2.py"
    fail_on_critical: true
    fail_on_high: false  # Warn only for HIGH
    evidence_logging: true

roadmap_integration:
  sprint_3_shards:
    target_date: "2025-12-31"
    scope: "Implement 16 shard middleware stubs"
    affected_placeholders: 440
    status: "PLANNED"
    roadmap_file: "roadmap/sprint3_shards.md"

  sprint_4_integrations:
    target_date: "2026-03-31"
    scope: "Complete utility integration hooks"
    affected_placeholders: 50
    status: "BACKLOG"
    roadmap_file: "roadmap/sprint4_integrations.md"

audit_trail:
  evidence_directory: "23_compliance/evidence/sprint2/placeholder_deferral/"
  report_format: "JSON"
  retention_period: "7_years"
  hash_algorithm: "SHA-256"

  required_evidence:
    - "Placeholder scan results (before/after policy)"
    - "Whitelist justification (roadmap references)"
    - "Sprint 3+ timeline commitment"
    - "Compliance officer sign-off"

compliance_score_impact:
  before_policy:
    placeholder_count: 450
    audit_status: "NON-COMPLIANT (undocumented)"
    score_penalty: -10

  after_policy:
    placeholder_count: 450  # Same count
    compliant_placeholders: 440  # Whitelisted per policy
    non_compliant_placeholders: 10  # Fixed in Week 1
    audit_status: "COMPLIANT (policy-documented deferral)"
    score_improvement: +10
    net_score_change: 0  # Neutral (from -10 to baseline)

metadata:
  created: "2025-10-09"
  version: "1.0.0"
  maintainer: "SSID Compliance Team"
  review_frequency: "quarterly"
  next_review: "2026-01-09"
  compliance_status: "ENFORCED"
  approved_by:
    - role: "Compliance Officer"
      name: "[TBD - requires sign-off]"
      date: null
    - role: "Engineering Lead"
      name: "[TBD - requires sign-off]"
      date: null
    - role: "Security Team Lead"
      name: "[TBD - requires sign-off]"
      date: null

references:
  - title: "Phased Implementation Strategy"
    url: "23_compliance/architecture/phased_rollout.md"
  - title: "Sprint 3 Shard Roadmap"
    url: "roadmap/sprint3_shards.md"
  - title: "Placeholder Remediation Plan (Sprint 2)"
    url: "23_compliance/reports/placeholder_remediation_plan_sprint2.md"

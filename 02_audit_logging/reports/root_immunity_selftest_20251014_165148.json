{
  "version": "1.0",
  "test_type": "ROOT_IMMUNITY_SELFTEST",
  "timestamp": "2025-10-14T16:51:48.231122+00:00",
  "immunity_scale": 26.67,
  "status": "COMPROMISED",
  "attacks_launched": 5,
  "attacks_blocked": 2,
  "attacks_failed": 3,
  "attacks": [
    {
      "attack_id": "4SOMANLA",
      "type": "INVALID_PATHS",
      "severity": "CRITICAL",
      "timestamp": "2025-10-14T16:51:46.587425+00:00",
      "description": "Created files outside allowed 24 roots",
      "techniques": [
        {
          "technique": "Root-level file outside allowed roots",
          "file": "INVALID_ROOT_FILE.txt",
          "expected": "BLOCKED",
          "actual": "ALLOWED",
          "passed": false
        },
        {
          "technique": "Invalid root directory (25_invalid_root)",
          "directory": "25_invalid_root/",
          "expected": "BLOCKED",
          "actual": "ALLOWED",
          "passed": false
        },
        {
          "technique": "Nested invalid directory structure",
          "directory": "random_folder/nested/",
          "expected": "BLOCKED",
          "actual": "ALLOWED",
          "passed": false
        }
      ],
      "techniques_passed": 0,
      "techniques_total": 3,
      "success_rate": 0.0
    },
    {
      "attack_id": "Z8ICZ742",
      "type": "WHITELIST_MANIPULATION",
      "severity": "CRITICAL",
      "timestamp": "2025-10-14T16:51:47.036540+00:00",
      "description": "Attempted to manipulate exception policy",
      "techniques": [
        {
          "technique": "Inject fake exception into policy",
          "exception": "MALICIOUS_FILE.exe",
          "expected": "DETECTED",
          "actual": "DETECTED",
          "passed": true
        },
        {
          "technique": "Modify .claude allowed_roots",
          "modification": "Added 03_core to .claude whitelist",
          "expected": "STILL_BLOCKED",
          "actual": "STILL_BLOCKED",
          "passed": true
        }
      ],
      "techniques_passed": 2,
      "techniques_total": 2,
      "success_rate": 1.0
    },
    {
      "attack_id": "4R9G0QLJ",
      "type": "CLAUDE_UNAUTHORIZED",
      "severity": "HIGH",
      "timestamp": "2025-10-14T16:51:47.067749+00:00",
      "description": "Created .claude directories outside allowed roots",
      "techniques": [
        {
          "technique": ".claude in 03_core",
          "location": "03_core/.claude/",
          "expected": "BLOCKED",
          "actual": "ALLOWED",
          "passed": false
        },
        {
          "technique": ".claude in 08_identity_score",
          "location": "08_identity_score/.claude/",
          "expected": "BLOCKED",
          "actual": "ALLOWED",
          "passed": false
        },
        {
          "technique": ".claude in 11_test_simulation",
          "location": "11_test_simulation/.claude/",
          "expected": "BLOCKED",
          "actual": "ALLOWED",
          "passed": false
        },
        {
          "technique": ".claude in 15_infra",
          "location": "15_infra/.claude/",
          "expected": "BLOCKED",
          "actual": "ALLOWED",
          "passed": false
        }
      ],
      "techniques_passed": 0,
      "techniques_total": 4,
      "success_rate": 0.0
    },
    {
      "attack_id": "SYF9K0IN",
      "type": "MANIFEST_TAMPERING",
      "severity": "CRITICAL",
      "timestamp": "2025-10-14T16:51:47.648943+00:00",
      "description": "Attempted to tamper with root structure manifest",
      "techniques": [
        {
          "technique": "Add 25th root to manifest",
          "modification": "allowed_roots: 25, count: 25",
          "expected": "DETECTED",
          "actual": "DETECTED",
          "passed": true
        },
        {
          "technique": "Modify ROOT-LOCK identifier",
          "modification": "root_lock: ROOT-25-LOCK",
          "expected": "DETECTED",
          "actual": "DETECTED",
          "passed": true
        }
      ],
      "techniques_passed": 2,
      "techniques_total": 2,
      "success_rate": 1.0
    },
    {
      "attack_id": "PXBBK7YG",
      "type": "HIDDEN_PATH_INJECTION",
      "severity": "MEDIUM",
      "timestamp": "2025-10-14T16:51:47.665966+00:00",
      "description": "Created hidden paths not in exception policy",
      "techniques": [
        {
          "technique": "Hidden file: .hidden_config",
          "path": ".hidden_config",
          "expected": "BLOCKED",
          "actual": "ALLOWED",
          "passed": false
        },
        {
          "technique": "Hidden file: .secrets",
          "path": ".secrets",
          "expected": "BLOCKED",
          "actual": "ALLOWED",
          "passed": false
        },
        {
          "technique": "Hidden file: .malicious_cache",
          "path": ".malicious_cache",
          "expected": "BLOCKED",
          "actual": "ALLOWED",
          "passed": false
        },
        {
          "technique": "Hidden file: .backdoor",
          "path": ".backdoor",
          "expected": "BLOCKED",
          "actual": "ALLOWED",
          "passed": false
        }
      ],
      "techniques_passed": 0,
      "techniques_total": 4,
      "success_rate": 0.0
    }
  ],
  "opa_evaluation": {
    "evaluated": false,
    "reason": "OPA not installed",
    "immunity_scale": 26.666666666666668
  },
  "daemon_failures": [],
  "recommendations": [
    "⚠️  CRITICAL: Immunity scale below 95% threshold",
    "Action: Review daemon blocking logic immediately",
    "⚠️  3 attack(s) not fully blocked",
    "   - Fix: Root-level file outside allowed roots allowed when should be blocked",
    "   - Fix: Invalid root directory (25_invalid_root) allowed when should be blocked",
    "   - Fix: Nested invalid directory structure allowed when should be blocked",
    "   - Fix: .claude in 03_core allowed when should be blocked",
    "   - Fix: .claude in 08_identity_score allowed when should be blocked",
    "   - Fix: .claude in 11_test_simulation allowed when should be blocked",
    "   - Fix: .claude in 15_infra allowed when should be blocked",
    "   - Fix: Hidden file: .hidden_config allowed when should be blocked",
    "   - Fix: Hidden file: .secrets allowed when should be blocked",
    "   - Fix: Hidden file: .malicious_cache allowed when should be blocked",
    "   - Fix: Hidden file: .backdoor allowed when should be blocked"
  ]
}